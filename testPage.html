<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Page</title>

	<link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>

	<canvas id="canvas" height="300" width="400" style="
	height:300;
	width:400;
	border:1px solid black;
	"> </canvas>

	<img id="TEST_ROOM_R" style="display:none;"src="assets/rooms/testroom.png"/>
	
	<script src="zone.js"></script>
	<script src="astar.js"></script>
	
	<script src="game-data.js"></script>
	<script src="game-interactions.js"></script>
	<script src="game-conversations.js"></script>
	
	<script>
	
	var h = 300, w = 400;
	var c = document.getElementById('canvas');
	var ctx = c.getContext('2d');
	
	function plotBackground(room) {
		var img = document.getElementById(room.id);		
		ctx.drawImage(img,0,0);
	}
		
	function plotZone(zone, color,fill) {
	
		ctx.beginPath();
	
		if (zone.constructor.name === 'PolyZone') {
			ctx.moveTo(zone.corners[0].x, h - zone.corners[0].y);
			for (var i=1; i<zone.corners.length; i++) {
				ctx.lineTo(zone.corners[i].x, h- zone.corners[i].y);
			}
			ctx.closePath();			
		};
	
		if (zone.constructor.name === 'RectZone') {
			ctx.moveTo(zone.left,h-zone.top);
			ctx.lineTo(zone.right,h-zone.top);
			ctx.lineTo(zone.right,h-zone.bottom);
			ctx.lineTo(zone.left,h-zone.bottom);
		};

		ctx.strokeStyle = fill ? 'white' : color || 'red';
		ctx.stroke();
		
		ctx.fillStyle = fill ?  color || 'red' :'rgba(100,100,100,0.1)';
		ctx.fill();
	};
	
	function testGrid(size, zone) {
		var rows = Math.ceil(h/size);
		var cols = Math.ceil(w/size);
		var cell;
	
		for (i=0; i<cols; i++) {
			for (j=0; j<rows; j++) {
			
				cell = new RectZone(i*size, j*size,size,size);
				
				plotZone(cell, zone.overlapsRectangle(cell) ? 'rgba(200,0,0,0.3)' : 'rgba(0,200,0,0.3)', true );
			
			}
		}
	
	}
	
	function testPoint (x,y,zone) {
		var p = new Point (x,y);
		ctx.beginPath();
		ctx.moveTo(p.x-5, h-p.y-5);
		ctx.lineTo(p.x+5,h-p.y+5);
		ctx.moveTo(p.x+5, h-p.y-5);
		ctx.lineTo(p.x-5,h-p.y+5);
		ctx.strokeStyle= 'black';
		ctx.stroke();

		ctx.beginPath();
		ctx.moveTo(p.x-5, h-p.y-5);
		ctx.lineTo(p.x+5,h-p.y+5);
		ctx.moveTo(p.x+5, h-p.y-5);
		ctx.lineTo(p.x-5,h-p.y+5);
		ctx.strokeStyle= zone.containsPoint(p)? "red" : "green";
		ctx.stroke();

	}

	function plotLine(p1,p2,color='black') {
		ctx.beginPath();
		ctx.moveTo(p1.x,h-p1.y);
		ctx.lineTo(p2.x,h-p2.y);
		ctx.strokeStyle=color;
		ctx.stroke();
	}

	plotBackground(rooms[2]);
	var z = rooms[2].obstacles[2];
	testGrid(5,z);
	plotZone(z,'blue');

	for(r=0; r<400; r++){
	//	 testPoint( Math.random()*w, Math.random()*h,z )
	}
	testPoint( 30, 50,z )
	
	</script>
	
</body>
</html>

